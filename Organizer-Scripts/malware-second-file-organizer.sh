#!/bin/bash

find /root/MOS-tpot/Malware-Files/Files -ls  | while read line
  do
    fileName=$(echo $line | awk '{ print $11}')
    CryptoBot=$(tar -tzf "$fileName" 2>/dev/null)

#    echo "$CryptoBot"

    if [[ "$CryptoBot" == *".rsync"* ]]

    then
    cp $fileName /root/MOS-tpot/Malware-Files/Files/Crypto-Miners/ > /dev/null 2>&1
    rm $fileName > /dev/null 2>&1 | echo "Organizing found Crypto-Miners...."
#    echo "I'm a crypto-bot!"

    else
    cp $fileName /root/MOS-tpot/Malware-Files/Files/Raw-Executables/ > /dev/null 2>&1 
    rm $fileName > /dev/null 2>&1  | echo "Organizing found executables..."
#    echo "I'm an executable!"

    fi
   done

find /root/MOS-tpot/Malware-Files/Files/Crypto-Miners -ls | while read line
  do
   fileName=$(echo $line | awk '{print $11}')
   BruteForceMiner1=b2142a3225706350ad94f357d8eda04a3bbd27af79830b1dcce999fe17aea5ea
   BtcMiner1=b08dc10135f22618794adaa33eaeb48db4443405df739f52e7882263a842cc88
   CointMiner=dbdc9d34d0ce9f190a5862a1a252a39cc536b7acde277635f4f7ccf66d909e97
   DDoSScript=b33b30c3cc7e027320e4d203303cc36a4e84b44451278bbb524ec54d5f61a4d6
   SSHCert=a8460f446be540410004b1a8db4083773fa46f7fe76fa84219c93daa1669f8f2
   BtcMiner2=5ddda323af992ec7346d4091801024b7ad593810ac6d8965458562dce7646e97
   MiraiADownloadScript=e80bea4739bc5eb96b187a2ba67e9544767a322603896b505bac3696eb16202b
   XorDDoS1=fa0a5c652d3a69d21ce4a5eb65f95537d880fd41190d73eaffc38aa070047108
   Hajime=d5601202dff3017db238145ff21857415f663031aca9b3d534bec8991b12179a
   BtcMiner3=786a868aaad38d0cebfced349b3a40a1bb846f7c7156202c5115696f5065cff7
   BruteForceMiner2=b2142a3225706350ad94f357d8eda04a3bbd27af79830b1dcce999fe17aea5ea
   LinuxAgent=d16909c7ce402f47eeae3649515d0b797c3ea4fccef11c5707fd099a97d83d81
   BruteForceMiner3=ea5eb41f229d055fb75568111328c3a1505437eb60c403c318ec47553d40535b
   XorDDoS2=86a8a2107448d28214e43a86e1367feec9e7f45201a3013c57bc200bf760e1ee
   BurterForceMiner4=68fc1a8c3ae18151863481c87a8d1af5e190278f32f4865893b6c59727574bda

     if [[ "$fileName" == "$BruteForceMiner1" ]]
      then
       cp $fileName /root/MOS-tpot/Malware-Files/Identified-Hash/Brute-Force-Miner-1
       rm $fileName > /dev/null 2>&1
       echo "Found Brute Force Miner 1"

      elif [[ "$fileName" == "$BtcMiner1" ]]
      then
       cp $fileName /root/MOS-tpot/Malware-Files/Identified-Hash/BctMiner-1
       rm $fileName > /dev/null 2>&1
       echo "Found Bct Miner 1"

     elif [[ "$fileName" == "$CoinMiner" ]]
      then
       cp $fileName /root/MOS-tpot/Malware-Files/Identified-Hash/CoinMiner
       rm $fileName > /dev/null 2>&1
       echo "Found CoinMiner"

     elif [[ "$fileName" == "$DDoSScript" ]]
      then
       cp $fileName /root/MOS-tpot/Malware-Files/Identified-Hash/DDoSScript-Downloader
       rm $fileName > /dev/null 2>&1
       echo "Found DDoS Script Downloader"

     elif [[ "$fileName" == "$SSHCert"  ]]
      then
       cp $fileName /root/MOS-tpot/Malware-Files/Identified-Hash/SSHCert
       rm $fileName > /dev/null 2>&1
       echo "Found SSH Certificate"

     elif [[ "$fileName" == "$BtcMiner2" ]]
      then
       cp $fileName /root/MOS-tpot/Malware-Files/Identified-Hash/BctMiner-2
       rm $fileName > /dev/null 2>&1
       echo "Found Bct Miner 2"

     elif [[ "$fileName" == "$MiraiADownloadScript" ]]
      then
       cp $fileName /root/MOS-tpot/Malware-Files/Identified-Hash/Mirai-Downloader-Script
       rm $fileName > /dev/null 2>&1
       echo "Found Mirai A Downloader Script"

     elif [[ "$fileName" == "$XorDDoS1"" ]]
      then
       cp $fileName /root/MOS-tpot/Malware-Files/Identified-Hash/XorDDoS
       rm $fileName > /dev/null 2>&1
       echo "Found XorDDoS executable"

     elif [[ "$fileName" == "$Hajime" ]]
      then
       cp $fileName /root/MOS-tpot/Malware-Files/Identified-Hash/Hajime
       rm $fileName > /dev/null 2>&1
       echo "Found a Hajime executable"

     elif [[ "$fileName" == "$BtcMiner3" ]]
      then
       cp $fileName /root/MOS-tpot/Malware-Files/Identified-Hash/BctMiner-3
       rm $fileName > /dev/null 2>&1
       echo "Found Bct Miner 3"

     elif [[ "$fileName" == "$BruteForceMiner2" ]]
      then
       cp $fileName /root/MOS-tpot/Malware-Files/Identified-Hash/BruteForceMiner-2
       rm $fileName > /dev/null 2>&1
       echo "Found Brute Force Miner 2"

     elif [[ "$fileName" == "$LinuxAgent" ]]
      then
       cp $fileName /root/MOS-tpot/Malware-Files/Identified-Hash/LinuxAgent
       rm $fileName > /dev/null 2>&1
       echo "Found Linux Agent executable"

     elif [[ "$fileName" == "$BruteForceMiner3" ]]
      then
       cp $fileName /root/MOS-tpot/Malware-Files/Identified-Hash/BruteForceMiner-3
       rm $fileName > /dev/null 2>&1
       echo "Found Brute Force Miner 3"

     elif [[ "$fileName" == "$XorDDoS2" ]]
      then
       cp $fileName /root/MOS-tpot/Malware-Files/Identified-Hash/XorDDoS-2
       rm $fileName > /dev/null 2>&1
       echo "Found a XorDDoS executable variant"

     elif [[ "$fileName" == "$BruteForceMiner4" ]]
      then
       cp $fileName /root/MOS-tpot/Malware-Files/Identified-Hash/BruteForceMiner-4
       rm $fileName > /dev/null 2>&1
       echo "Found Brute Force Miner 4"

done

find /root/MOS-tpot/Malware-Files/Files/Raw-Executables -ls | while read line
  do
   fileName=$(echo $line | awk '{print $11}')
   BruteForceMiner1=b2142a3225706350ad94f357d8eda04a3bbd27af79830b1dcce999fe17aea5ea
   BtcMiner1=b08dc10135f22618794adaa33eaeb48db4443405df739f52e7882263a842cc88
   CointMiner=dbdc9d34d0ce9f190a5862a1a252a39cc536b7acde277635f4f7ccf66d909e97
   DDoSScript=b33b30c3cc7e027320e4d203303cc36a4e84b44451278bbb524ec54d5f61a4d6
   SSHCert=a8460f446be540410004b1a8db4083773fa46f7fe76fa84219c93daa1669f8f2
   BtcMiner2=5ddda323af992ec7346d4091801024b7ad593810ac6d8965458562dce7646e97
   MiraiADownloadScript=e80bea4739bc5eb96b187a2ba67e9544767a322603896b505bac3696eb16202b
   XorDDoS1=fa0a5c652d3a69d21ce4a5eb65f95537d880fd41190d73eaffc38aa070047108
   Hajime=d5601202dff3017db238145ff21857415f663031aca9b3d534bec8991b12179a
   BtcMiner3=786a868aaad38d0cebfced349b3a40a1bb846f7c7156202c5115696f5065cff7
   BruteForceMiner2=b2142a3225706350ad94f357d8eda04a3bbd27af79830b1dcce999fe17aea5ea
   LinuxAgent=d16909c7ce402f47eeae3649515d0b797c3ea4fccef11c5707fd099a97d83d81
   BruteForceMiner3=ea5eb41f229d055fb75568111328c3a1505437eb60c403c318ec47553d40535b
   XorDDoS2=86a8a2107448d28214e43a86e1367feec9e7f45201a3013c57bc200bf760e1ee
   BurterForceMiner4=68fc1a8c3ae18151863481c87a8d1af5e190278f32f4865893b6c59727574bda

     if [[ "$fileName" == "$BruteForceMiner1" ]]
      then
       cp $fileName /root/MOS-tpot/Malware-Files/Identified-Hash/Brute-Force-Miner-1
       rm $fileName > /dev/null 2>&1
       echo "Found Brute Force Miner 1"

      elif [[ "$fileName" == "$BtcMiner1" ]]
      then
       cp $fileName /root/MOS-tpot/Malware-Files/Identified-Hash/BctMiner-1
       rm $fileName > /dev/null 2>&1
       echo "Found Bct Miner 1"

     elif [[ "$fileName" == "$CoinMiner" ]]
      then
       cp $fileName /root/MOS-tpot/Malware-Files/Identified-Hash/CoinMiner
       rm $fileName > /dev/null 2>&1
       echo "Found CoinMiner"

     elif [[ "$fileName" == "$DDoSScript" ]]
      then
       cp $fileName /root/MOS-tpot/Malware-Files/Identified-Hash/DDoSScript-Downloader
       rm $fileName > /dev/null 2>&1
       echo "Found DDoS Script Downloader"

     elif [[ "$fileName" == "$SSHCert"  ]]
      then
       cp $fileName /root/MOS-tpot/Malware-Files/Identified-Hash/SSHCert
       rm $fileName > /dev/null 2>&1
       echo "Found SSH Certificate"

     elif [[ "$fileName" == "$BtcMiner2" ]]
      then
       cp $fileName /root/MOS-tpot/Malware-Files/Identified-Hash/BctMiner-2
       rm $fileName > /dev/null 2>&1
       echo "Found Bct Miner 2"

     elif [[ "$fileName" == "$MiraiADownloadScript" ]]
      then
       cp $fileName /root/MOS-tpot/Malware-Files/Identified-Hash/Mirai-Downloader-Script
       rm $fileName > /dev/null 2>&1
       echo "Found Mirai A Downloader Script"

     elif [[ "$fileName" == "$XorDDoS1"" ]]
      then
       cp $fileName /root/MOS-tpot/Malware-Files/Identified-Hash/XorDDoS
       rm $fileName > /dev/null 2>&1
       echo "Found XorDDoS executable"

     elif [[ "$fileName" == "$Hajime" ]]
      then
       cp $fileName /root/MOS-tpot/Malware-Files/Identified-Hash/Hajime
       rm $fileName > /dev/null 2>&1
       echo "Found a Hajime executable"

     elif [[ "$fileName" == "$BtcMiner3" ]]
      then
       cp $fileName /root/MOS-tpot/Malware-Files/Identified-Hash/BctMiner-3
       rm $fileName > /dev/null 2>&1
       echo "Found Bct Miner 3"

     elif [[ "$fileName" == "$BruteForceMiner2" ]]
      then
       cp $fileName /root/MOS-tpot/Malware-Files/Identified-Hash/BruteForceMiner-2
       rm $fileName > /dev/null 2>&1
       echo "Found Brute Force Miner 2"

     elif [[ "$fileName" == "$LinuxAgent" ]]
      then
       cp $fileName /root/MOS-tpot/Malware-Files/Identified-Hash/LinuxAgent
       rm $fileName > /dev/null 2>&1
       echo "Found Linux Agent executable"

     elif [[ "$fileName" == "$BruteForceMiner3" ]]
      then
       cp $fileName /root/MOS-tpot/Malware-Files/Identified-Hash/BruteForceMiner-3
       rm $fileName > /dev/null 2>&1
       echo "Found Brute Force Miner 3"

     elif [[ "$fileName" == "$XorDDoS2" ]]
      then
       cp $fileName /root/MOS-tpot/Malware-Files/Identified-Hash/XorDDoS-2
       rm $fileName > /dev/null 2>&1
       echo "Found a XorDDoS executable variant"

     elif [[ "$fileName" == "$BruteForceMiner4" ]]
      then
       cp $fileName /root/MOS-tpot/Malware-Files/Identified-Hash/BruteForceMiner-4
       rm $fileName > /dev/null 2>&1
       echo "Found Brute Force Miner 4"

done



#!/bin/bash

if [ $UID -ne 0 ]; then
	echo "This script must be run with sudo privileges"
	exit 1
fi

cp Malware-Organizer.sh /bin/

mkdir /root/MOS-tpot/Cowrie-Download-File > /dev/null 2>&1

echo "Copying Cowrie Downloaded Data..."
cp -Rf /data/cowrie/downloads.tgz /root/MOS-tpot/Cowrie-Download-File/ > /dev/null 2>&1

echo "Unzipping downloads.tgz..."
#gzip -d /root/MOS-tpot/Cowrie-Download-File/downloads.tgz.2.gz
tar -xvf /root/MOS-tpot/Cowrie-Download-File/downloads.tgz > /dev/null 2>&1
mv data/ Cowrie-Download-File/

echo "Creating Required File Structure..."
bash /root/MOS-tpot/Organizer-Scripts/malware-organizer-file-creator.sh > /dev/null 2>&1

echo "Organizing and Moving Files to Proper Directories..."
bash /root/MOS-tpot/Organizer-Scripts/malware-initial-file-organizer.sh > /dev/null 2>&1

echo "Differentiating Between Crypto-Bots and Executables..."
bash /root/MOS-tpot/Organizer-Scripts/malware-second-file-organizer.sh > /dev/null 2>&1

echo "Identifying Known Crypto-Bots and Organizing..."
bash /root/MOS-tpot/Organizer-Scripts/malware-third-file-organizer.sh > /dev/null 2>&1

#echo "Separating and Organizing Executables..."
#bash /root/MOS-tpot/Organizer-Scripts/malware-fourth-file-organizer.sh > /dev/null 2>&1

#echo "Looking for Scripts..."
#echo "Separating Text Files and Possible Scripts!"
#bash /root/MOS-tpot/Organizer-Scripts/malware-fifth-file-organizer.sh > /dev/null 2>&1

echo "Looking for possible SSH TCP Proxy Attacks"
bash /root/MOS-tpot/Organizer-Scripts/TCP-Proxy-Attacks.sh > /dev/null 2>&1

echo "Organization Complete. Go into the 'Malware Files' directory to view results!"
